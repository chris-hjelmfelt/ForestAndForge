<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Forest and Forge</title>
</head>
  <script src="pixi.min.js"></script>
<body>
  <script type="text/javascript">
    let type = "WebGL"
    if(!PIXI.utils.isWebGLSupported()){
      type = "canvas"
    }
		
		//Aliases
		let Application = PIXI.Application,
				loader = PIXI.loader,
				resources = PIXI.loader.resources,
				Sprite = PIXI.Sprite;
				Rectangle = PIXI.Rectangle;

		//Create a Pixi Applirocketion
		let app = new Application({ 
				width: 512, 
				height: 512,                       
				antialias: true, 
				transparent: false, 
				resolution: 1
			}
		);

		//Add the canvas that Pixi automatically created for you to the HTML document
		document.body.appendChild(app.view);

		//load an image and run the `setup` function when it's done
		loader
      .add("avatar2.jpg")
      .add("tileset.png")
      .add("TilesetPeople.png")
      .add("TilesetRuins.png")
      .add("TilesetTrees.png")
			.load(setup);

		let state, message, player, forge;
		
		//This `setup` function will run when the image has loaded
		function setup() {
		
			// A place to display messages
			message = new PIXI.Text("Hello Pixi!");
			app.stage.addChild(message);
			message.position.set(20, 460);
			message.style = {fill: "white", font: "16px PetMe64"};			   
  
      getSprites();

			//Set the game state
			state = play;
			
			//Start the game loop by adding the `gameLoop` function to
			//Pixi's `ticker` and providing it with a `delta` argument.
			app.ticker.add(delta => gameLoop(delta));
		}

		function gameLoop(delta){
			//Update the current game state:
			state(delta);
		}

		function play(delta) {
			//message.text = player.vx;
			//Use the player's velocity to make it move
			player.x += player.vx;
			player.y += player.vy
      
      // make player come back around
			if (player.x > 512)			
        player.x = 0;
      if (player.y > 512)  
        player.y = 0;
      if (player.x < 0)			
        player.x = 512;
      if (player.y < 0)  
        player.y = 512;		
				
			//check for a collision between the player and the box
			if (hitTestRectangle(player, forge)) {
				message.text = "Touching";
      } else {
				message.text = "";
			}					
    }		
  </script>

  <!-- Javascript for keyboard input -->
  <script type="text/javascript" src="keyboard.js"></script>
  <!-- Javascript for collision detection -->
  <script type="text/javascript" src="collision.js"></script>
  <!-- Javascript for loading sprites -->
  <script type="text/javascript" src="sprites.js"></script>
</body>
</html>